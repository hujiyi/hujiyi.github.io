<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 07——游戏音效 | Laohoo</title><meta name="author" content="laohoodman"><meta name="copyright" content="laohoodman"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  音频 在 层级管理器 创建名为 audio 的 空节点, 然后在 audio 节点上再创建一个 空节点，命名为 bgm(backgroundmusic), 点击选中 bgm 节点, 在 属性检查器">
<meta property="og:type" content="article">
<meta property="og:title" content="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 07——游戏音效">
<meta property="og:url" content="https://hujiyi.github.io/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/index.html">
<meta property="og:site_name" content="Laohoo">
<meta property="og:description" content="开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  音频 在 层级管理器 创建名为 audio 的 空节点, 然后在 audio 节点上再创建一个 空节点，命名为 bgm(backgroundmusic), 点击选中 bgm 节点, 在 属性检查器">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png">
<meta property="article:published_time" content="2022-02-04T08:48:03.000Z">
<meta property="article:modified_time" content="2022-10-11T01:40:13.141Z">
<meta property="article:author" content="laohoodman">
<meta property="article:tag" content="cocos creator">
<meta property="article:tag" content="game">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hujiyi.github.io/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/index.html"><link rel="preconnect"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 07——游戏音效',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://hujiyi.github.io/2020/02/29/use-hexo-tag-cloud/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">56</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Laohoo</span></a><a class="nav-page-title" href="/"><span class="site-name">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 07——游戏音效</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 07——游戏音效</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-04T08:48:03.000Z" title="发表于 2022-02-04 16:48:03">2022-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-11T01:40:13.141Z" title="更新于 2022-10-11 09:40:13">2022-10-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/cocos-creator/">cocos creator</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h1><ol>
<li>Cocos Dashboard 1.0.20</li>
<li>Cocos Creator 3.4.0</li>
<li>Visual Studio Code 1.63</li>
<li>Microsoft Edge 97.0.1072.69</li>
</ol>
<h1 id="音频"><a href="#音频" class="headerlink" title="音频"></a>音频</h1><ol>
<li>在 <code>层级管理器</code> 创建名为 <code>audio</code> 的 <code>空节点</code>, 然后在 <code>audio</code> 节点上再创建一个 <code>空节点</code>，命名为 <code>bgm</code>(backgroundmusic), 点击选中 <code>bgm</code> 节点, 在 <code>属性检查器</code> 点击 <code>添加组件</code> 按钮, 选择  <code>Audio</code> -&gt; <code>AudioSource</code>, 将 <code>资源管理器</code> 中的  <code>assets/res/audio/music/bgm</code> 拖动到 <code>bgm</code> 节点的 <code>Clip</code> 属性中, 选中 <code>Loop</code> 和 <code>PlayOnAwake</code> 两个属性,  <code>Volume</code> 属性的值改为 <code>0.8</code>。</li>
</ol>
<img src="/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/001.png" class="" title="BGM">

<ol start="2">
<li>在 <code>层级管理器</code> 点击选中 <code>plane01</code> 节点, 在其 <code>属性检查器</code> 点击 <code>添加组件</code> 按钮, 选择  <code>Audio</code> -&gt; <code>AudioSource</code>, 将 <code>资源管理器</code> 中的  <code>assets/res/audio/sound/player</code> 拖动到其 <code>Clip</code> 属性中, <code>取消</code> 选中 <code>Loop</code> 和 <code>PlayOnAwake</code> 两个属性。</li>
</ol>
<img src="/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/002.png" class="" title="player">

<ol start="3">
<li><p>在 <code>资源管理器</code> 点击选中 <code>assets/script/framework</code> 文件夹，<code>右键</code> -&gt; <code>创建</code> -&gt; <code>脚本(TypeScript)</code>, 命名为 <code>AudioManager</code>, 脚本文件暂时不用编辑内容。</p>
</li>
<li><p>在 <code>层级管理器</code> 点击选中 <code>audio</code> 节点, <code>右键</code> -&gt; <code>创建</code> -&gt; <code>空节点</code>, 命名为 <code>effect</code>, 在其 <code>属性检查器</code> 点击 <code>添加组件</code> 按钮, 选择  <code>Audio</code> -&gt; <code>AudioSource</code>; 再点击一次 <code>添加组件</code> 按钮, 选择  <code>自定义脚本</code> -&gt; <code>AudioManager</code>。</p>
</li>
</ol>
<img src="/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/003.png" class="" title="AudioManager">

<ol start="5">
<li>编辑脚本 <code>AudioManager</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; _decorator, <span class="title class_">Component</span>, <span class="title class_">Node</span>, <span class="title class_">AudioClip</span>, <span class="title class_">AudioSource</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; ccclass, property &#125; = _decorator;</span><br><span class="line"></span><br><span class="line">interface <span class="title class_">IAudioMap</span> &#123;</span><br><span class="line">    [<span class="attr">name</span>: string]: <span class="title class_">AudioClip</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_">ccclass</span>(<span class="string">&#x27;AudioManager&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AudioManager</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">    @<span class="title function_">property</span>([<span class="title class_">AudioClip</span>])</span><br><span class="line">    public <span class="attr">audioList</span>: <span class="title class_">AudioClip</span>[] = [];</span><br><span class="line"></span><br><span class="line">    private <span class="attr">_dict</span>: <span class="title class_">IAudioMap</span> = &#123;&#125;;</span><br><span class="line">    private <span class="attr">_audioSource</span>: <span class="title class_">AudioSource</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">audioList</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">const</span> element = <span class="variable language_">this</span>.<span class="property">audioList</span>[i];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_dict</span>[element.<span class="property">name</span>] = element;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sound: &#x27;</span>, <span class="variable language_">this</span>.<span class="property">_dict</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_audioSource</span> = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">AudioSource</span>)!;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public <span class="title function_">play</span>(<span class="params">name: string</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> audioClip = <span class="variable language_">this</span>.<span class="property">_dict</span>[name];</span><br><span class="line">        <span class="keyword">if</span> (audioClip !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;play audio:&#x27;</span>, audioClip.<span class="property">name</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_audioSource</span>.<span class="title function_">playOneShot</span>(audioClip);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>编辑 <code>GameManager</code> 脚本, 添加对 <code>AudioManager</code> 进行管理的代码:</li>
</ol>
<ul>
<li><p>添加属性</p>
</li>
<li><p>添加方法 playAudioEffect()</p>
</li>
<li><p>更新方法: update()</p>
</li>
</ul>
<p>完整代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; _decorator, <span class="title class_">Component</span>, <span class="title class_">Node</span>, <span class="title class_">Prefab</span>, instantiate, math, <span class="title class_">Vec3</span>, <span class="title class_">BoxCollider</span>, <span class="title class_">Label</span>, <span class="title class_">Animation</span>, macro &#125; <span class="keyword">from</span> <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Bullet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../bullet/Bullet&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BulletProp</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../bullet/BulletProp&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">EnemyPlane</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../plane/EnemyPlane&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PlayerPlane</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../plane/PlayerPlane&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AudioManager</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AudioManager&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Constant</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./Constant&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; ccclass, property &#125; = _decorator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@<span class="title function_">ccclass</span>(<span class="string">&#x27;GameManager&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">GameManager</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">PlayerPlane</span>)</span><br><span class="line">    public <span class="attr">playerPlane</span>: <span class="title class_">PlayerPlane</span> = <span class="literal">null</span>; <span class="comment">// 玩家飞机</span></span><br><span class="line"></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bullet01</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>; <span class="comment">// 子弹1</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bullet02</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>; <span class="comment">// 子弹2</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bullet03</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>; <span class="comment">// 子弹3</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bullet04</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>; <span class="comment">// 子弹4</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bullet05</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>; <span class="comment">// 子弹5</span></span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    public shootTime = <span class="number">0.3</span>; <span class="comment">// 射击周期（间隔时间）</span></span><br><span class="line">    @property</span><br><span class="line">    public bulletSpeed = <span class="number">1</span>;  <span class="comment">// 子弹速度</span></span><br><span class="line"></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">bulletRoot</span>: <span class="title class_">Node</span> = <span class="literal">null</span>; <span class="comment">// 子弹管理节点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 敌机</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">enemy01</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;  <span class="comment">// 敌机1</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">enemy02</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;  <span class="comment">// 敌机2</span></span><br><span class="line">    @property</span><br><span class="line">    public createEnemyTime = <span class="number">1</span>;  <span class="comment">// 敌机生成时间</span></span><br><span class="line">    @property</span><br><span class="line">    public enemy01Speed = <span class="number">0.5</span>;  <span class="comment">// 敌机1速度</span></span><br><span class="line">    @property</span><br><span class="line">    public enemy02Speed = <span class="number">0.7</span>;  <span class="comment">// 敌机2速度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 子弹类型道具</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bulletPropM</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bulletPropH</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Prefab</span>)</span><br><span class="line">    public <span class="attr">bulletPropS</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;</span><br><span class="line">    @property</span><br><span class="line">    public bulletPropSpeed = <span class="number">0.3</span>;  <span class="comment">// 子弹类型道具速度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ui</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">gamePage</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">gameOverPage</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Label</span>)</span><br><span class="line">    public <span class="attr">gameScore</span>: <span class="title class_">Label</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Label</span>)</span><br><span class="line">    public <span class="attr">gameOverScore</span>: <span class="title class_">Label</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Animation</span>)</span><br><span class="line">    public <span class="attr">overAnimation</span>: <span class="title class_">Animation</span> = <span class="literal">null</span>;  <span class="comment">// Animation 要手工添加导入</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// audio</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">AudioManager</span>)</span><br><span class="line">    public <span class="attr">audioEffect</span>: <span class="title class_">AudioManager</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    public isGameStart = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    private _currShootTime = <span class="number">0</span>;</span><br><span class="line">    private _isShooting = <span class="literal">false</span>;</span><br><span class="line">    private _currCreateEnemyTiime = <span class="number">0</span>;  <span class="comment">// 当前敌机的生成时间</span></span><br><span class="line">    private _combinationInterval = <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN1</span>;   <span class="comment">// 组合的间隔状态</span></span><br><span class="line">    private _bulletType = <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_M</span>;  <span class="comment">// 子弹道具类型</span></span><br><span class="line"></span><br><span class="line">    private <span class="attr">_score</span>: number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_init</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">update</span>(<span class="params">deltaTime: number</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isGameStart</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">isDie</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">gameOver</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currShootTime</span> += deltaTime;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_isShooting</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">_currShootTime</span> &gt; <span class="variable language_">this</span>.<span class="property">shootTime</span>) &#123;</span><br><span class="line">            <span class="comment">// 判断子弹道具的类型</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_bulletType</span> === <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_H</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">createPlayerBulletH</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_bulletType</span> === <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_S</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">createPlayerBulletS</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">createPlayerBulletM</span>();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 子弹的音效，用除2的余数得到名字后面的数字字符</span></span><br><span class="line">            <span class="keyword">let</span> name = <span class="string">&#x27;bullet&#x27;</span> + (<span class="variable language_">this</span>.<span class="property">_bulletType</span> % <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;player shooting: &#x27;</span>,name);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">playAudioEffect</span>(name);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_currShootTime</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> += deltaTime;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断组合方式创建相应的敌机</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_combinationInterval</span> === <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> &gt; <span class="variable language_">this</span>.<span class="property">createEnemyTime</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">createEnemyPlane</span>();</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_combinationInterval</span> === <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN2</span>) &#123;</span><br><span class="line">            <span class="comment">// 第二阶段，前两种组合随机出现</span></span><br><span class="line">            <span class="comment">// 这里乘以 0.9 是缩短敌机出现的间隔时间</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> &gt; <span class="variable language_">this</span>.<span class="property">createEnemyTime</span> * <span class="number">0.9</span>) &#123;</span><br><span class="line">                <span class="comment">// 用于随机出现组合1或组合2</span></span><br><span class="line">                <span class="keyword">const</span> randomCombination = math.<span class="title function_">randomRangeInt</span>(<span class="number">1</span>, <span class="number">6</span>);</span><br><span class="line">                <span class="keyword">if</span> (randomCombination === <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN2</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">createCombination01</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">createEnemyPlane</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 第三阶段，三个组合随机出现</span></span><br><span class="line">            <span class="comment">// 这里乘以 0.9 是缩短敌机出现的间隔时间</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> &gt; <span class="variable language_">this</span>.<span class="property">createEnemyTime</span> * <span class="number">0.8</span>) &#123;</span><br><span class="line">                <span class="comment">// 用于随机出现组合1或组合2</span></span><br><span class="line">                <span class="keyword">const</span> randomCombination = math.<span class="title function_">randomRangeInt</span>(<span class="number">1</span>, <span class="number">7</span>);</span><br><span class="line">                <span class="keyword">if</span> (randomCombination === <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN2</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">createCombination01</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (randomCombination === <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN3</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">createCombination02</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">createEnemyPlane</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建玩家飞机的子弹</span></span><br><span class="line">    public <span class="title function_">createPlayerBulletM</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 实例材质类型的子弹, 实例出来的对象不在场景中</span></span><br><span class="line">        <span class="keyword">const</span> bullet = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet01</span>);</span><br><span class="line">        bullet.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> pos = <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">node</span>.<span class="property">position</span>; <span class="comment">// 获取玩家飞机位置</span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet.<span class="title function_">setPosition</span>(pos.<span class="property">x</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet类 （子弹预制根节点添加 Bullet 脚本）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp = bullet.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        bulletComp.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>); <span class="comment">// 设置子弹速度</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// S型子弹为前方同时发射两颗</span></span><br><span class="line">    public <span class="title function_">createPlayerBulletH</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> pos = <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">node</span>.<span class="property">position</span>; <span class="comment">// 获取玩家飞机位置</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 左边的子弹</span></span><br><span class="line">        <span class="keyword">const</span> bullet1 = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet03</span>);</span><br><span class="line">        bullet1.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中        </span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet1.<span class="title function_">setPosition</span>(pos.<span class="property">x</span> - <span class="number">2.5</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet 组件 （脚本类）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp1 = bullet1.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// bulletComp.bulletSpeed = this.bulletSpeed; // 设置子弹速度</span></span><br><span class="line">        bulletComp1.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>);   <span class="comment">// 玩家飞机的子弹速度</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 右边的子弹</span></span><br><span class="line">        <span class="keyword">const</span> bullet2 = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet03</span>);</span><br><span class="line">        bullet2.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中        </span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet2.<span class="title function_">setPosition</span>(pos.<span class="property">x</span> + <span class="number">2.5</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet 组件 （脚本类）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp2 = bullet2.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// bulletComp.bulletSpeed = this.bulletSpeed; // 设置子弹速度</span></span><br><span class="line">        bulletComp2.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>);   <span class="comment">// 玩家飞机的子弹速度</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// S型子弹为三发</span></span><br><span class="line">    public <span class="title function_">createPlayerBulletS</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> pos = <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">node</span>.<span class="property">position</span>; <span class="comment">// 获取玩家飞机位置</span></span><br><span class="line">        <span class="comment">// 中间子弹</span></span><br><span class="line">        <span class="keyword">const</span> bullet1 = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet05</span>);</span><br><span class="line">        bullet1.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中        </span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet1.<span class="title function_">setPosition</span>(pos.<span class="property">x</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet 组件 （脚本类）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp1 = bullet1.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// bulletComp.bulletSpeed = this.bulletSpeed; // 设置子弹速度</span></span><br><span class="line">        bulletComp1.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>);   <span class="comment">// 玩家飞机的子弹速度</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 左边子弹</span></span><br><span class="line">        <span class="keyword">const</span> bullet2 = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet05</span>);</span><br><span class="line">        bullet2.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中        </span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet2.<span class="title function_">setPosition</span>(pos.<span class="property">x</span> - <span class="number">4</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet 组件 （脚本类）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp2 = bullet2.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// bulletComp.bulletSpeed = this.bulletSpeed; // 设置子弹速度</span></span><br><span class="line">        bulletComp2.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>, <span class="title class_">Constant</span>.<span class="property">Direction</span>.<span class="property">LEFT</span>);   <span class="comment">// 玩家飞机的子弹速度</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 右边子弹</span></span><br><span class="line">        <span class="keyword">const</span> bullet3 = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet05</span>);</span><br><span class="line">        bullet3.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中        </span></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet3.<span class="title function_">setPosition</span>(pos.<span class="property">x</span> + <span class="number">4</span>, pos.<span class="property">y</span>, pos.<span class="property">z</span> - <span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 获取 Bullet 组件 （脚本类）</span></span><br><span class="line">        <span class="keyword">const</span> bulletComp3 = bullet3.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// bulletComp.bulletSpeed = this.bulletSpeed; // 设置子弹速度</span></span><br><span class="line">        bulletComp3.<span class="title function_">show</span>(<span class="variable language_">this</span>.<span class="property">bulletSpeed</span>, <span class="literal">false</span>, <span class="title class_">Constant</span>.<span class="property">Direction</span>.<span class="property">RIGHT</span>);   <span class="comment">// 玩家飞机的子弹速度</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否处理触摸状态，触摸才发射子弹</span></span><br><span class="line">    public <span class="title function_">isShooting</span>(<span class="params">value: boolean</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_isShooting</span> = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">createEnemyPlane</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// math 是 cc 带的数字模块</span></span><br><span class="line">        <span class="keyword">const</span> whichEnemy = math.<span class="title function_">randomRangeInt</span>(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="attr">prefab</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> speed = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (whichEnemy === <span class="title class_">Constant</span>.<span class="property">EnemyType</span>.<span class="property">TYPE1</span>) &#123;</span><br><span class="line">            prefab = <span class="variable language_">this</span>.<span class="property">enemy01</span>;</span><br><span class="line">            speed = <span class="variable language_">this</span>.<span class="property">enemy01Speed</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prefab = <span class="variable language_">this</span>.<span class="property">enemy02</span>;</span><br><span class="line">            speed = <span class="variable language_">this</span>.<span class="property">enemy02Speed</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实例化预制 </span></span><br><span class="line">        <span class="keyword">const</span> enemy = <span class="title function_">instantiate</span>(prefab);</span><br><span class="line">        enemy.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">node</span>); <span class="comment">// 预制挂载到组件中</span></span><br><span class="line">        <span class="keyword">const</span> enemyComp = enemy.<span class="title function_">getComponent</span>(<span class="title class_">EnemyPlane</span>);</span><br><span class="line">        enemyComp.<span class="title function_">show</span>(<span class="variable language_">this</span>, speed, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 敌机随机出现的X轴(左右)坐标范围</span></span><br><span class="line">        <span class="keyword">const</span> randomPos = math.<span class="title function_">randomRangeInt</span>(-<span class="number">25</span>, <span class="number">26</span>);</span><br><span class="line">        enemy.<span class="title function_">setPosition</span>(randomPos, <span class="number">0</span>, -<span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 敌机出现组合1：5架飞机一字型同时出现</span></span><br><span class="line">    public <span class="title function_">createCombination01</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> enemyArray = <span class="keyword">new</span> <span class="title class_">Array</span>&lt;<span class="title class_">Node</span>&gt;(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; enemyArray.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            enemyArray[i] = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">enemy01</span>);</span><br><span class="line">            <span class="keyword">const</span> element = enemyArray[i];</span><br><span class="line">            element.<span class="property">parent</span> = <span class="variable language_">this</span>.<span class="property">node</span>;</span><br><span class="line">            element.<span class="title function_">setPosition</span>(-<span class="number">20</span> + i * <span class="number">10</span>, <span class="number">0</span>, -<span class="number">50</span>);</span><br><span class="line">            <span class="keyword">const</span> enemyComp = element.<span class="title function_">getComponent</span>(<span class="title class_">EnemyPlane</span>);</span><br><span class="line">            enemyComp.<span class="title function_">show</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">enemy01Speed</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 敌机出现组合1, 7架飞机V字型出现</span></span><br><span class="line">    public <span class="title function_">createCombination02</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> enemyArray = <span class="keyword">new</span> <span class="title class_">Array</span>&lt;<span class="title class_">Node</span>&gt;(<span class="number">7</span>);</span><br><span class="line">        <span class="comment">// 7 架敌机的初始坐标</span></span><br><span class="line">        <span class="keyword">const</span> combinationPos = [</span><br><span class="line">            -<span class="number">21</span>, <span class="number">0</span>, -<span class="number">60</span>,</span><br><span class="line">            -<span class="number">14</span>, <span class="number">0</span>, -<span class="number">55</span>,</span><br><span class="line">            -<span class="number">7</span>, <span class="number">0</span>, -<span class="number">50</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">0</span>, -<span class="number">45</span>,</span><br><span class="line">            <span class="number">7</span>, <span class="number">0</span>, -<span class="number">50</span>,</span><br><span class="line">            <span class="number">14</span>, <span class="number">0</span>, -<span class="number">55</span>,</span><br><span class="line">            <span class="number">21</span>, <span class="number">0</span>, -<span class="number">60</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; enemyArray.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            enemyArray[i] = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">enemy02</span>);</span><br><span class="line">            <span class="keyword">const</span> element = enemyArray[i];</span><br><span class="line">            element.<span class="property">parent</span> = <span class="variable language_">this</span>.<span class="property">node</span>;</span><br><span class="line">            <span class="keyword">const</span> startIndex = i * <span class="number">3</span>;</span><br><span class="line">            element.<span class="title function_">setPosition</span>(combinationPos[startIndex],</span><br><span class="line">                combinationPos[startIndex + <span class="number">1</span>],</span><br><span class="line">                combinationPos[startIndex + <span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">const</span> enemyComp = element.<span class="title function_">getComponent</span>(<span class="title class_">EnemyPlane</span>);</span><br><span class="line">            enemyComp.<span class="title function_">show</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">enemy02Speed</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 敌机发射子弹</span></span><br><span class="line">    public <span class="title function_">createEnemyBullet</span>(<span class="params">targetPos: Vec3</span>) &#123;</span><br><span class="line">        <span class="comment">// 实例材质类型的子弹, 实例出来的对象不在场景中</span></span><br><span class="line">        <span class="keyword">const</span> bullet = <span class="title function_">instantiate</span>(<span class="variable language_">this</span>.<span class="property">bullet01</span>);</span><br><span class="line">        bullet.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">bulletRoot</span>); <span class="comment">// 子弹挂载到子弹管理节点中</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 子弹出现的位置为飞机 Z轴 -7</span></span><br><span class="line">        bullet.<span class="title function_">setPosition</span>(targetPos.<span class="property">x</span>, targetPos.<span class="property">y</span>, targetPos.<span class="property">z</span> + <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">const</span> bulletComp = bullet.<span class="title function_">getComponent</span>(<span class="title class_">Bullet</span>);</span><br><span class="line">        <span class="comment">// 敌机的子弹速度 要比敌机大一些</span></span><br><span class="line">        bulletComp.<span class="title function_">show</span>(<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取子弹的碰撞器组件</span></span><br><span class="line">        <span class="keyword">const</span> colliderComp = bullet.<span class="title function_">getComponent</span>(<span class="title class_">BoxCollider</span>);</span><br><span class="line">        <span class="comment">// 设置敌机子弹的碰撞矩阵</span></span><br><span class="line">        colliderComp.<span class="title function_">setGroup</span>(<span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">ENEMY_BULLET</span>);</span><br><span class="line">        <span class="comment">// 设置碰撞掩码 与 玩家飞机 碰撞</span></span><br><span class="line">        colliderComp.<span class="title function_">setMask</span>(<span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">PLAYER_PLANE</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更换玩家子弹类型    </span></span><br><span class="line">    public <span class="title function_">changeBulletType</span>(<span class="params">type: number</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_bulletType</span> = type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建子弹道具  </span></span><br><span class="line">    public <span class="title function_">createBulletProp</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> randomProp = math.<span class="title function_">randomRangeInt</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;create bullet prop:&#x27;</span>, randomProp);</span><br><span class="line">        <span class="keyword">let</span> <span class="attr">prefab</span>: <span class="title class_">Prefab</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (randomProp === <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_H</span>) &#123;</span><br><span class="line">            prefab = <span class="variable language_">this</span>.<span class="property">bulletPropH</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (randomProp === <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_S</span>) &#123;</span><br><span class="line">            prefab = <span class="variable language_">this</span>.<span class="property">bulletPropS</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prefab = <span class="variable language_">this</span>.<span class="property">bulletPropM</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实例化子弹道具预览</span></span><br><span class="line">        <span class="keyword">const</span> prop = <span class="title function_">instantiate</span>(prefab);</span><br><span class="line">        prop.<span class="title function_">setParent</span>(<span class="variable language_">this</span>.<span class="property">node</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// const prop = PoolManager.instance().getNode(prefab, this.node);</span></span><br><span class="line"></span><br><span class="line">        prop.<span class="title function_">setPosition</span>(<span class="number">15</span>, <span class="number">0</span>, -<span class="number">50</span>);  <span class="comment">// 道具的起始位置</span></span><br><span class="line">        <span class="keyword">const</span> propComp = prop.<span class="title function_">getComponent</span>(<span class="title class_">BulletProp</span>);</span><br><span class="line">        propComp.<span class="title function_">show</span>(<span class="variable language_">this</span>, -<span class="variable language_">this</span>.<span class="property">bulletPropSpeed</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public <span class="title function_">returnMain</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currShootTime</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> = <span class="number">0</span>;  <span class="comment">// 当前敌机的生成时间</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_combinationInterval</span> = <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN1</span>;   <span class="comment">// 组合的间隔状态</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_bulletType</span> = <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_M</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">node</span>.<span class="title function_">setPosition</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_score</span> = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">gameReStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">gameStart</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currShootTime</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currCreateEnemyTiime</span> = <span class="number">0</span>;  <span class="comment">// 当前敌机的生成时间        </span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_combinationInterval</span> = <span class="title class_">Constant</span>.<span class="property">Combination</span>.<span class="property">PLAN1</span>;   <span class="comment">// 组合的间隔状态</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_bulletType</span> = <span class="title class_">Constant</span>.<span class="property">BulletPropType</span>.<span class="property">BULLET_M</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">node</span>.<span class="title function_">setPosition</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">gameStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isGameStart</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="title function_">init</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_changePlaneModel</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_score</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameScore</span>.<span class="property">string</span> = <span class="variable language_">this</span>.<span class="property">_score</span>.<span class="title function_">toString</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">gameOver</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_isShooting</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isGameStart</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gamePage</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameOverPage</span>.<span class="property">active</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameOverScore</span>.<span class="property">string</span> = <span class="variable language_">this</span>.<span class="property">_score</span>.<span class="title function_">toString</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">overAnimation</span>.<span class="title function_">play</span>();  <span class="comment">// 播放游戏结束的动画</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameScore</span>.<span class="property">string</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        <span class="comment">// this.playerPlane.init();</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">unschedule</span>(<span class="variable language_">this</span>.<span class="property">_modeChanged</span>);  <span class="comment">// 取消定时器</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_destoryAll</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">addScore</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_score</span>++;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameScore</span>.<span class="property">string</span> = <span class="variable language_">this</span>.<span class="property">_score</span>.<span class="title function_">toString</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">playAudioEffect</span>(<span class="params">name: string</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">audioEffect</span>.<span class="title function_">play</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_destoryAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> children = <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">children</span>;</span><br><span class="line">        <span class="keyword">let</span> length = children.<span class="property">length</span>;</span><br><span class="line">        <span class="comment">// 销毁对象时要从后往前，不能从前往后</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> index = length - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line">            <span class="keyword">const</span> child = children[index];</span><br><span class="line">            child.<span class="title function_">destroy</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        children = <span class="variable language_">this</span>.<span class="property">bulletRoot</span>.<span class="property">children</span>;</span><br><span class="line">        length = children.<span class="property">length</span>;</span><br><span class="line">        <span class="comment">// 销毁对象时要从后往前，不能从前往后</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> index = length - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line">            <span class="keyword">const</span> child = children[index];</span><br><span class="line">            child.<span class="title function_">destroy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 用于按下的时候即发射第一颗子弹</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currShootTime</span> = <span class="variable language_">this</span>.<span class="property">shootTime</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_changePlaneModel</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定时器函数</span></span><br><span class="line">    private <span class="title function_">_changePlaneModel</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// this.schedule()四个参数：回调， 间隔时间，重复次数， 延迟时间</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">schedule</span>(<span class="variable language_">this</span>.<span class="property">_modeChanged</span>, <span class="number">10</span>, macro.<span class="property">REPEAT_FOREVER</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 改变组合状态</span></span><br><span class="line">    private <span class="title function_">_modeChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_combinationInterval</span>++;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">createBulletProp</span>();  <span class="comment">// 创建子弹道具</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>编辑 <code>EnemyPlane</code> 脚本， 添加敌人飞机 <code>销毁</code> 的音效</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; _decorator, <span class="title class_">Component</span>, <span class="title class_">Node</span>, <span class="title class_">Collider</span>, <span class="title class_">ITriggerEvent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Constant</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../framework/Constant&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">GameManager</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../framework/GameManager&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; ccclass, property &#125; = _decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 敌机被销毁的位置(超出屏幕下边沿后的Z轴坐标值)</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OUTOFBOUNCE</span> = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">@<span class="title function_">ccclass</span>(<span class="string">&#x27;EnemyPlane&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">EnemyPlane</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    public createBulletTime = <span class="number">0.5</span>;  <span class="comment">// 敌机子弹发射周期</span></span><br><span class="line"></span><br><span class="line">    private _enemySpeed = <span class="number">0</span>;</span><br><span class="line">    private _needBullet = <span class="literal">false</span>;  <span class="comment">// 敌机是否发射子弹</span></span><br><span class="line">    private _currCreateBulletTime = <span class="number">0</span>;  <span class="comment">// 敌机当前子弹发射周期</span></span><br><span class="line">    private <span class="attr">_gameManager</span>: <span class="title class_">GameManager</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onEnable</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 获取碰撞组件</span></span><br><span class="line">        <span class="keyword">const</span> collider = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">Collider</span>);</span><br><span class="line">        <span class="comment">// 监听触发事件</span></span><br><span class="line">        collider.<span class="title function_">on</span>(<span class="string">&#x27;onTriggerEnter&#x27;</span>, <span class="variable language_">this</span>.<span class="property">_onTriggerEnter</span>, <span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onDisable</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 获取碰撞组件</span></span><br><span class="line">        <span class="keyword">const</span> collider = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">Collider</span>);</span><br><span class="line">        <span class="comment">// 停止监听触发事件</span></span><br><span class="line">        collider.<span class="title function_">off</span>(<span class="string">&#x27;onTriggerEnter&#x27;</span>, <span class="variable language_">this</span>.<span class="property">_onTriggerEnter</span>, <span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_onTriggerEnter</span>(<span class="params">event: ITriggerEvent</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取分组</span></span><br><span class="line">        <span class="keyword">const</span> collisionGroup = event.<span class="property">otherCollider</span>.<span class="title function_">getGroup</span>();</span><br><span class="line">        <span class="comment">// 遇到玩家飞机或子弹，敌人飞机销毁</span></span><br><span class="line">        <span class="keyword">if</span> (collisionGroup === <span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">PLAYER_PLANE</span></span><br><span class="line">            || collisionGroup === <span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">PLAYER_BULLET</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;trigger enemy destroy&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_gameManager</span>.<span class="title function_">playAudioEffect</span>(<span class="string">&#x27;enemy&#x27;</span>);  <span class="comment">// 播放声音</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">destroy</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_gameManager</span>.<span class="title function_">addScore</span>();  <span class="comment">// 分数增加           </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">update</span>(<span class="params">deltaTime: number</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> pos = <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">position</span>;</span><br><span class="line">        <span class="comment">// 敌机向下飞 pos.z 值要增加</span></span><br><span class="line">        <span class="keyword">let</span> movePos = pos.<span class="property">z</span> + <span class="variable language_">this</span>.<span class="property">_enemySpeed</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 增加用于判断是否要发射子弹</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_needBullet</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_currCreateBulletTime</span> += deltaTime;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_currCreateBulletTime</span> &gt; <span class="variable language_">this</span>.<span class="property">createBulletTime</span>) &#123;</span><br><span class="line">                <span class="comment">// 敌机发射子弹，需要在 GameManager 添加相应函数</span></span><br><span class="line">                <span class="comment">// this.node.position 是发射子弹时敌机的位置</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_gameManager</span>.<span class="title function_">createEnemyBullet</span>(<span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">position</span>);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_currCreateBulletTime</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">setPosition</span>(pos.<span class="property">x</span>, pos.<span class="property">y</span>, movePos);</span><br><span class="line">        <span class="keyword">if</span> (movePos &gt; <span class="variable constant_">OUTOFBOUNCE</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">destroy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">show</span>(<span class="params">gameManager: GameManager, speed: number, needBullet: boolean = <span class="literal">false</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_gameManager</span> = gameManager;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_enemySpeed</span> = speed;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_needBullet</span> = needBullet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>编辑 <code>PlayerPlane</code> 脚本， 添加玩家飞机的音效</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; _decorator, <span class="title class_">Component</span>, <span class="title class_">Node</span>, <span class="title class_">Collider</span>, <span class="title class_">ITriggerEvent</span>, <span class="title class_">AudioSource</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Constant</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../framework/Constant&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; ccclass, property &#125; = _decorator;</span><br><span class="line"></span><br><span class="line">@<span class="title function_">ccclass</span>(<span class="string">&#x27;PlayerPlane&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">PlayerPlane</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">    public lifeValue = <span class="number">5</span>;  <span class="comment">//玩家飞机生命</span></span><br><span class="line">    public isDie = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    private _currLife = <span class="number">0</span>;</span><br><span class="line">    private <span class="attr">_audioSource</span>: <span class="title class_">AudioSource</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onEnable</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 获取碰撞组件</span></span><br><span class="line">        <span class="keyword">const</span> collider = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">Collider</span>);</span><br><span class="line">        <span class="comment">// 监听触发事件</span></span><br><span class="line">        collider.<span class="title function_">on</span>(<span class="string">&#x27;onTriggerEnter&#x27;</span>, <span class="variable language_">this</span>.<span class="property">_onTriggerEnter</span>, <span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onDisable</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> collider = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">Collider</span>);</span><br><span class="line">        <span class="comment">// 停止监听触发事件</span></span><br><span class="line">        collider.<span class="title function_">off</span>(<span class="string">&#x27;onTriggerEnter&#x27;</span>, <span class="variable language_">this</span>.<span class="property">_onTriggerEnter</span>, <span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_audioSource</span> = <span class="variable language_">this</span>.<span class="title function_">getComponent</span>(<span class="title class_">AudioSource</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_currLife</span> = <span class="variable language_">this</span>.<span class="property">lifeValue</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isDie</span> = <span class="literal">false</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_onTriggerEnter</span>(<span class="params">event: ITriggerEvent</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取分组</span></span><br><span class="line">        <span class="keyword">const</span> collisionGroup = event.<span class="property">otherCollider</span>.<span class="title function_">getGroup</span>();</span><br><span class="line">        <span class="comment">// 遇到敌方飞机或敌方子弹，玩家飞机掉血</span></span><br><span class="line">        <span class="keyword">if</span> (collisionGroup === <span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">ENEMY_PLANE</span></span><br><span class="line">            || collisionGroup === <span class="title class_">Constant</span>.<span class="property">CollistionType</span>.<span class="property">ENEMY_BULLET</span>) &#123;</span><br><span class="line">            <span class="comment">// 现在玩家飞机发生碰撞只在控制台输出文件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_currLife</span>--;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;player plane reduce blood:&#x27;</span>, <span class="variable language_">this</span>.<span class="property">_currLife</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_currLife</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isDie</span> = <span class="literal">true</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_audioSource</span>.<span class="title function_">play</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>编辑 <code>UIManager</code> 脚本，添加按钮音效</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; _decorator, <span class="title class_">Component</span>, <span class="title class_">Node</span>, <span class="title class_">Touch</span>, <span class="title class_">EventTouch</span>, <span class="title class_">Input</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">GameManager</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../framework/GameManager&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; ccclass, property &#125; = _decorator;</span><br><span class="line"></span><br><span class="line">@<span class="title function_">ccclass</span>(<span class="string">&#x27;UIManager&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UIManager</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    public playerPlaneSpeed = <span class="number">1</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">playerPlane</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加游戏控制脚本</span></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">GameManager</span>)</span><br><span class="line">    public <span class="attr">gameManager</span>: <span class="title class_">GameManager</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">gameStart</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">game</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line">    @<span class="title function_">property</span>(<span class="title class_">Node</span>)</span><br><span class="line">    public <span class="attr">gameOver</span>: <span class="title class_">Node</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">on</span>(<span class="title class_">Input</span>.<span class="property">EventType</span>.<span class="property">TOUCH_START</span>, <span class="variable language_">this</span>.<span class="property">_touchStart</span>, <span class="variable language_">this</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">on</span>(<span class="title class_">Input</span>.<span class="property">EventType</span>.<span class="property">TOUCH_MOVE</span>, <span class="variable language_">this</span>.<span class="property">_touchMove</span>, <span class="variable language_">this</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">node</span>.<span class="title function_">on</span>(<span class="title class_">Input</span>.<span class="property">EventType</span>.<span class="property">TOUCH_END</span>, <span class="variable language_">this</span>.<span class="property">_touchEnd</span>, <span class="variable language_">this</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameStart</span>.<span class="property">active</span> = <span class="literal">true</span>;   <span class="comment">// 显示开始界面</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重新开始按钮对应代码</span></span><br><span class="line">    public <span class="title function_">reStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameOver</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">game</span>.<span class="property">active</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">audioEffect</span>.<span class="title function_">play</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="title function_">gameReStart</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回主页按钮代码</span></span><br><span class="line">    public <span class="title function_">returnMain</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameOver</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameStart</span>.<span class="property">active</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">audioEffect</span>.<span class="title function_">play</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="title function_">returnMain</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_touchMove</span>(<span class="params">touch: Touch, event: EventTouch</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">isGameStart</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// touch.getDelta() 获取当前触点值与上一次触点值的差值</span></span><br><span class="line">        <span class="keyword">let</span> delta = touch.<span class="title function_">getDelta</span>();</span><br><span class="line">        <span class="keyword">let</span> pos = <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="property">position</span>;  <span class="comment">// 获取当前节点的位置</span></span><br><span class="line">        <span class="comment">// 在速度前乘以 0.01 是用于调整移动的速度</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">playerPlane</span>.<span class="title function_">setPosition</span>(</span><br><span class="line">            pos.<span class="property">x</span> + <span class="number">0.01</span> * <span class="variable language_">this</span>.<span class="property">playerPlaneSpeed</span> * delta.<span class="property">x</span>,</span><br><span class="line">            pos.<span class="property">y</span>,</span><br><span class="line">            pos.<span class="property">z</span> - <span class="number">0.01</span> * <span class="variable language_">this</span>.<span class="property">playerPlaneSpeed</span> * delta.<span class="property">y</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始触摸屏幕的回调方法</span></span><br><span class="line">    private <span class="title function_">_touchStart</span>(<span class="params">touch: Touch, event: EventTouch</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">isGameStart</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="title function_">isShooting</span>(<span class="literal">true</span>); <span class="comment">// 触摸屏幕时玩家飞机开始射击</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameStart</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">game</span>.<span class="property">active</span> = <span class="literal">true</span>; </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">audioEffect</span>.<span class="title function_">play</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="title function_">gameStart</span>();</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">_touchEnd</span>(<span class="params">touch: Touch, event: EventTouch</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="property">isGameStart</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 停止触摸时玩家飞机结束射击</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameManager</span>.<span class="title function_">isShooting</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="10">
<li>在 <code>层级管理器</code> 点击选中 <code>audio/effect</code> 节点, 其 <code>AudioList</code> 属性的值改为 <code>4</code>, 点击名字左边的 <code>三角符号</code>, 依次将 <code>bullet1</code>、<code>bullet2</code>、<code>button</code>、<code>enemy</code> 四个音效拖进去。</li>
</ol>
<img src="/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/004.png" class="" title="AudioManager">

<ol start="11">
<li>在 <code>层级管理器</code> 中将 <code>audio/effect</code> 节点关联到 <code>gameManager</code> 节点的属性 <code>AudioEfect</code>  。</li>
</ol>
<img src="/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/005.png" class="" title="AudioManager">

<ol start="12">
<li>保存场景, 运行预览。</li>
</ol>
<p>&#x3D;&#x3D;&#x3D;END&#x3D;&#x3D;&#x3D;</p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://hujiyi.github.io">laohoodman</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://hujiyi.github.io/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/">https://hujiyi.github.io/2022/02/04/develop-an-airplane-game-in-cocos-creator-07/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://hujiyi.github.io" target="_blank">Laohoo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cocos-creator/">cocos creator</a><a class="post-meta__tags" href="/tags/game/">game</a></div><div class="post-share"><div class="social-share" data-image="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/02/05/develop-an-airplane-game-in-cocos-creator-08/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 08(完)——粒子和血条"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 08(完)——粒子和血条</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  游戏配套素材资源下载：游戏开发配套素材资源 导入特效资源 下载并解压游戏配套资源,  res/particle package/ 文件夹包含已经制作好的一些特效资源  1234567891011.|-- audio|-- effect|-- particle package|   |-- ball.zip           --- 场景装饰：星球     |   |-- cloudStars.zip     --- 场景装饰：背景云层特效     |   |-- explode.zip        --- 玩家飞机爆炸粒子特效     |   |-- explodeSmall.zip   --- 敌人飞机爆炸粒子特效     |   |-- stone.zip          --- 场景装饰：石头     |   `-- tailFlame.zip      ---...</div></div></div></a><a class="pagination-related" href="/2022/02/03/develop-an-airplane-game-in-cocos-creator-06/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 06——游戏界面"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 06——游戏界面</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  界面宽度和高度 当前游戏只有一个场景: 主场景。界面则分为三个部分：主界面(gameStart), 游戏界面(game)和结算界面(gameOver)。     在 主菜单 选择 项目 -&gt; 项目设置, 在弹出的 项目设置 窗口 左侧 选中 项目数据, 右侧 窗格中的 设计宽度 改为 640, 设计高度 改为 960, 关闭窗口。    游戏主界面(开始界面) 在 资源管理器 中点击选中图片 assets/res/texture/logo, 在 属性检查器 中将图片 logo.png 的属性 Type(图片类型) 更改为 sprite-frame, 保存更改。     点击 场景编辑器 上方 3D 按钮，切换为 2D 模式。  在 层级管理器 点击选中 Canvas 节点，右键 -&gt; 创建 -&gt; 空节点, 命名为 gameStart。      在 层级管理器...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2022/02/05/develop-an-airplane-game-in-cocos-creator-08/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 08(完)——粒子和血条"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-05</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 08(完)——粒子和血条</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  游戏配套素材资源下载：游戏开发配套素材资源 导入特效资源 下载并解压游戏配套资源,  res/particle package/ 文件夹包含已经制作好的一些特效资源  1234567891011.|-- audio|-- effect|-- particle package|   |-- ball.zip           --- 场景装饰：星球     |   |-- cloudStars.zip     --- 场景装饰：背景云层特效     |   |-- explode.zip        --- 玩家飞机爆炸粒子特效     |   |-- explodeSmall.zip   --- 敌人飞机爆炸粒子特效     |   |-- stone.zip          --- 场景装饰：石头     |   `-- tailFlame.zip      ---...</div></div></div></a><a class="pagination-related" href="/2022/02/03/develop-an-airplane-game-in-cocos-creator-06/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 06——游戏界面"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-03</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 06——游戏界面</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69  界面宽度和高度 当前游戏只有一个场景: 主场景。界面则分为三个部分：主界面(gameStart), 游戏界面(game)和结算界面(gameOver)。     在 主菜单 选择 项目 -&gt; 项目设置, 在弹出的 项目设置 窗口 左侧 选中 项目数据, 右侧 窗格中的 设计宽度 改为 640, 设计高度 改为 960, 关闭窗口。    游戏主界面(开始界面) 在 资源管理器 中点击选中图片 assets/res/texture/logo, 在 属性检查器 中将图片 logo.png 的属性 Type(图片类型) 更改为 sprite-frame, 保存更改。     点击 场景编辑器 上方 3D 按钮，切换为 2D 模式。  在 层级管理器 点击选中 Canvas 节点，右键 -&gt; 创建 -&gt; 空节点, 命名为 gameStart。      在 层级管理器...</div></div></div></a><a class="pagination-related" href="/2022/01/31/develop-an-airplane-game-in-cocos-creator-05/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 05——玩家飞机获取道具更换子弹"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-31</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 05——玩家飞机获取道具更换子弹</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69   提供给玩家飞机的子弹道具玩家飞家可以发射的子弹类型分为三种：  M型：直线发射 1发 白色小子弹(默认) H型：直线发射 2发 红色小子弹 S型：扇形发射 3发 月牙型子弹，夹角为45度(或根据实际情况调整)  更换子弹的道具类型和出现方式：  道具每10秒出现一个，类型为 HSM 其中一种 收集到与当前不一样的道具时切换子弹类型 使用S型道具时玩家飞机比敌人飞机速度慢  创建子弹切换道具材质 在 资源管理器 的 assets/res/model/fightIconBullet/ 文件夹创建 材质, 命名为 bulletS。材质 Effect 属性的值设为 builltin-unlit, Technique 属性的值设为 03-alpha-blend， USE-TEXTURE 打勾, 将图片...</div></div></div></a><a class="pagination-related" href="/2022/01/31/develop-an-airplane-game-in-cocos-creator-04/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 04——飞机与子弹的碰撞"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-31</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 04——飞机与子弹的碰撞</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69   添加碰撞分组 在 主菜单 点击  项目 -&gt; 项目设置, 打开 项目设置 窗口。     在 物理 选项最下方的 碰撞矩阵 点 + 添加四个分组：PLAYER_PLANE, ENEMY_PLANE, PLAYER_BULLET, ENEMY_BULLET 。  设置分组的掩码：   123PLAYER_PLANE - ENEMY_BULLETPLAYER_PLANE - ENEMY_PLANEENEMY_PLANE - PLAYER_BULLET     设置完毕，关闭对话框。  设置碰撞组件和分组 在 层级管理器 点击选中 playerPlane 节点, 在其 属性检查器 中点 添加组件 -&gt; Physics -&gt; BoxCollider。     将 playerPlane 节点 属性检查器 中的 cc.BoxCollider+ 属性 Size...</div></div></div></a><a class="pagination-related" href="/2022/01/29/develop-an-airplane-game-in-cocos-creator-03/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 03——敌机出现"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-29</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 03——敌机出现</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69   制作敌人飞机 在 资源管理器 的 assets/script/ 创建名为 plane 的文件夹, 在 assets/script/plane/ 文件夹下创建脚本，命名为 EnemyPlane, 暂时不用编辑脚本内容。  在 资源管理器 的 assets/res/model/plane02 文件夹添加 材质，命名为 plane02, 修改 Effect 属性为 bulitin-unlit, 选中 USE TEXTURE, MainTexture 拖入图片 plane02, 保存材质。      复制上一步的材质到 assets/res/model/plane03 文件夹， 更改材质名为：plane03， 修改其 MainTexture 为图片plane03， 保存材质。  在 层级管理器 中创建一个 空节点，命名为 plane02, 将 资源管理器 中的 FBX 模型...</div></div></div></a><a class="pagination-related" href="/2022/01/24/develop-an-airplane-game-in-cocos-creator-02/" title="学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 02——玩家飞机"><img class="cover" src="https://hujiyi.github.io/2022/01/23/develop-an-airplane-game-in-cocos-creator-01/000.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-24</div><div class="info-item-2">学习笔记：使用 Cocos Creator 3.4.0 开发空战游戏 02——玩家飞机</div></div><div class="info-2"><div class="info-item-1">开发工具 Cocos Dashboard 1.0.20 Cocos Creator 3.4.0 Visual Studio Code 1.63 Microsoft Edge 97.0.1072.69   创建玩家飞机 在 层级管理器 中 创建一个空节点, 命名为 playerPlane, 在 资源管理器 中拖动的 FBX 模型 assets/res/model/plane01/plane01 到 playerPlane 节点中, 并将节点 playerPlane 下的模型名称 plane01(模型根节点) 改名为 body。     在 资源管理器 中点击选中 assets/res/model/plane01 文件夹, 右键 -&gt; 创建 -&gt; 材质, 命名为 playerPlane。     将材质 playerPlane 的属性 Effect 更改为 builtin-unlit; 属性 USE TEXTURE 打勾, 飞机图片 plane01 拖动到 MainTexture, 保存材质。     在 层级管理器 中, 点击选中...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://hujiyi.github.io/2020/02/29/use-hexo-tag-cloud/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">laohoodman</div><div class="author-info-description">如果你交给某人一个程序，你将折磨他一整天；如果你教某人如何编写程序，你将折磨他一辈子。 —— David Leinweber.</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">56</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hujiyi"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/hujiyi" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7"><span class="toc-number">1.</span> <span class="toc-text">开发工具</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91"><span class="toc-number">2.</span> <span class="toc-text">音频</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/16/learn-vue3-000/" title="Learn Vue3 目录"><img src="https://hujiyi.github.io/2024/11/16/hello-world/00/vuetoc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Learn Vue3 目录"/></a><div class="content"><a class="title" href="/2024/11/16/learn-vue3-000/" title="Learn Vue3 目录">Learn Vue3 目录</a><time datetime="2024-11-16T12:35:53.000Z" title="发表于 2024-11-16 20:35:53">2024-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/27/flutter-tutorial-toc/" title="Flutter Tutorial Table Of Content"><img src="https://hujiyi.github.io/2021/02/02/flutter-introduction-part-I/flutter_eman_blog.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Flutter Tutorial Table Of Content"/></a><div class="content"><a class="title" href="/2023/02/27/flutter-tutorial-toc/" title="Flutter Tutorial Table Of Content">Flutter Tutorial Table Of Content</a><time datetime="2023-02-27T05:11:08.000Z" title="发表于 2023-02-27 13:11:08">2023-02-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/linux-from-scratch-toc/" title="从 Linux From Scratch 构建自己的操作系统 - 目录"><img src="https://hujiyi.github.io/2023/02/16/linux-from-scratch-toc/Linux-From-Scratch.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="从 Linux From Scratch 构建自己的操作系统 - 目录"/></a><div class="content"><a class="title" href="/2023/02/16/linux-from-scratch-toc/" title="从 Linux From Scratch 构建自己的操作系统 - 目录">从 Linux From Scratch 构建自己的操作系统 - 目录</a><time datetime="2023-02-16T05:04:02.000Z" title="发表于 2023-02-16 13:04:02">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/05/installing-mysql-zip-archive-in-windows/" title="在 Windows 安装解压版的 MySQL 8"><img src="https://hujiyi.github.io/2023/01/05/installing-mysql-zip-archive-in-windows/admin-mysql-logo900.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在 Windows 安装解压版的 MySQL 8"/></a><div class="content"><a class="title" href="/2023/01/05/installing-mysql-zip-archive-in-windows/" title="在 Windows 安装解压版的 MySQL 8">在 Windows 安装解压版的 MySQL 8</a><time datetime="2023-01-05T05:05:51.000Z" title="发表于 2023-01-05 13:05:51">2023-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/21/build-vue3-desktop-app-with-vite-electron-vuetify/" title="使用 electron 和 vuetify 创建 Vue3 桌面应用程序"><img src="/2022/11/21/build-vue3-desktop-app-with-vite-electron-vuetify/electron.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 electron 和 vuetify 创建 Vue3 桌面应用程序"/></a><div class="content"><a class="title" href="/2022/11/21/build-vue3-desktop-app-with-vite-electron-vuetify/" title="使用 electron 和 vuetify 创建 Vue3 桌面应用程序">使用 electron 和 vuetify 创建 Vue3 桌面应用程序</a><time datetime="2022-11-21T01:23:54.000Z" title="发表于 2022-11-21 09:23:54">2022-11-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By laohoodman</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script src="/js/jquery.min.js"></script><script src="/js/fishes.js"></script><script src="/js/fish.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>